Welcome to the Emacs shell

~/Documents/Uni/RTpred/roi $ ranknet.py -i test.csv -t morgan3 --no_cache -e1 -b 2048
ranknet.py: command not found
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t morgan3 --no_cache -e1 -b 2048
2020-09-16 16:37:04.204713: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:37:04.204736: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 16:37:18.386161: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 16:37:18.390196: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 16:37:18.390599: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 16:37:18.390680: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:37:18.390747: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:37:18.391498: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 16:37:18.391705: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 16:37:18.393401: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 16:37:18.393492: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:37:18.393571: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 16:37:18.393579: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 16:37:18.393821: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 16:37:18.398453: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 16:37:18.398842: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557d0f01f710 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 16:37:18.398856: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 16:37:18.399798: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 16:37:18.399808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
2020-09-16 16:37:18.400800: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 171798691800 exceeds 10% of free system memory.
2020-09-16 16:37:18.400853: W tensorflow/core/framework/op_kernel.cc:1767] OP_REQUIRES failed at random_op.cc:77 : Resource exhausted: OOM when allocating tensor with shape[4294967295,10] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
Traceback (most recent call last):
  File "ranknet.py", line 575, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 187, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 31, in __init__
    self.model = self._build_model(input_size, hidden_layer_sizes, activation)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 49, in _build_model
    x1 = hidden_layers[i](x1)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 925, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 1098, in _functional_construction_call
    self._maybe_build(inputs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 2643, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/layers/core.py", line 1171, in build
    self.kernel = self.add_weight(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 597, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/base.py", line 745, in _add_variable_with_custom_getter
    new_variable = getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_utils.py", line 133, in make_variable
    return tf_variables.VariableV1(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 260, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 206, in _variable_v1_call
    return previous_getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 199, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variable_scope.py", line 2583, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 264, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1507, in __init__
    self._init_from_args(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1651, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/initializers/initializers_v2.py", line 397, in __call__
    return super(VarianceScaling, self).__call__(shape, dtype=_get_dtype(dtype))
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/init_ops_v2.py", line 561, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/init_ops_v2.py", line 1043, in random_uniform
    return op(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/random_ops.py", line 301, in random_uniform
    result = gen_random_ops.random_uniform(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/gen_random_ops.py", line 726, in random_uniform
    _ops.raise_from_not_ok_status(e, name)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 6843, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[4294967295,10] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu [Op:RandomUniform]
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 2048 --sizes 3 3
2020-09-16 16:52:09.530229: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:52:09.530254: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 16:52:23.721192: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 16:52:23.725251: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 16:52:23.725691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 16:52:23.725776: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:52:23.725845: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:52:23.726686: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 16:52:23.726912: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 16:52:23.728748: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 16:52:23.728861: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:52:23.728930: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 16:52:23.728939: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 16:52:23.729185: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 16:52:23.733701: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 16:52:23.734064: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e17b05ce30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 16:52:23.734077: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 16:52:23.735170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 16:52:23.735182: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
2020-09-16 16:52:23.736124: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 85899345900 exceeds 10% of free system memory.
2020-09-16 16:52:23.736163: W tensorflow/core/framework/op_kernel.cc:1767] OP_REQUIRES failed at random_op.cc:77 : Resource exhausted: OOM when allocating tensor with shape[4294967295,5] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu
Traceback (most recent call last):
  File "ranknet.py", line 574, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 187, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 31, in __init__
    self.model = self._build_model(input_size, hidden_layer_sizes, activation)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 49, in _build_model
    x1 = hidden_layers[i](x1)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 925, in __call__
    return self._functional_construction_call(inputs, args, kwargs,
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 1098, in _functional_construction_call
    self._maybe_build(inputs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 2643, in _maybe_build
    self.build(input_shapes)  # pylint:disable=not-callable
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/layers/core.py", line 1171, in build
    self.kernel = self.add_weight(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer.py", line 597, in add_weight
    variable = self._add_variable_with_custom_getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/training/tracking/base.py", line 745, in _add_variable_with_custom_getter
    new_variable = getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_utils.py", line 133, in make_variable
    return tf_variables.VariableV1(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 260, in __call__
    return cls._variable_v1_call(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 206, in _variable_v1_call
    return previous_getter(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 199, in <lambda>
    previous_getter = lambda **kwargs: default_variable_creator(None, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variable_scope.py", line 2583, in default_variable_creator
    return resource_variable_ops.ResourceVariable(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/variables.py", line 264, in __call__
    return super(VariableMetaclass, cls).__call__(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1507, in __init__
    self._init_from_args(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 1651, in _init_from_args
    initial_value() if init_from_fn else initial_value,
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/keras/initializers/initializers_v2.py", line 397, in __call__
    return super(VarianceScaling, self).__call__(shape, dtype=_get_dtype(dtype))
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/init_ops_v2.py", line 561, in __call__
    return self._random_generator.random_uniform(shape, -limit, limit, dtype)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/init_ops_v2.py", line 1043, in random_uniform
    return op(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py", line 201, in wrapper
    return target(*args, **kwargs)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/random_ops.py", line 301, in random_uniform
    result = gen_random_ops.random_uniform(
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/ops/gen_random_ops.py", line 726, in random_uniform
    _ops.raise_from_not_ok_status(e, name)
  File "/home/fleming/.local/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 6843, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.ResourceExhaustedError: OOM when allocating tensor with shape[4294967295,5] and type float on /job:localhost/replica:0/task:0/device:CPU:0 by allocator cpu [Op:RandomUniform]
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 2048 --sizes 3 3 --standardize
2020-09-16 16:52:44.618295: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:52:44.618319: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "ranknet.py", line 571, in <module>
    bg = BatchGenerator(train_x, train_y, args.batch_size)
  File "ranknet.py", line 34, in __init__
    self.x1_indices, self.x2_indices, self.y_trans = self._transform_pairwise(
  File "ranknet.py", line 48, in _transform_pairwise
    if (np.abs(self.y[i] - self.y[j]) <= self.delta):
KeyboardInterrupt
interrupt
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 2048 --sizes 3 3 --standardize
2020-09-16 16:52:55.666663: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:52:55.666685: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 16:53:08.249187: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 16:53:08.253321: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 16:53:08.253745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 16:53:08.253814: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 16:53:08.253867: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:53:08.254686: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 16:53:08.254900: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 16:53:08.256681: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 16:53:08.256780: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 16:53:08.256834: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 16:53:08.256842: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 16:53:08.257113: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 16:53:08.261572: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 16:53:08.261943: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55ed45523240 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 16:53:08.261956: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 16:53:08.263085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 16:53:08.263096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
 Epoch 1/2
2255/2255 [==============================] - 11s 5ms/step - loss: 0.3773 - val_loss: 0.4260
Epoch 2/2
2255/2255 [==============================] - 11s 5ms/step - loss: 0.3353 - val_loss: 0.4190
train:  0.8502777489132506
test:  0.8055225281602002
val:  0.8074685534591195
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 2048 --sizes 1 1 --standardize
2020-09-16 17:04:21.403891: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:04:21.403915: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:04:34.005519: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:04:34.011248: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:04:34.011720: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:04:34.011844: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:04:34.011941: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:04:34.013481: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:04:34.013796: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:04:34.015885: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:04:34.016051: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:04:34.016176: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:04:34.016201: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:04:34.016484: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:04:34.021649: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:04:34.022051: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561678e8b420 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:04:34.022076: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:04:34.023153: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:04:34.023163: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
 Epoch 1/2
2255/2255 [==============================] - 12s 5ms/step - loss: 0.3756 - val_loss: 0.4075
Epoch 2/2
2255/2255 [==============================] - 11s 5ms/step - loss: 0.3386 - val_loss: 0.4056
train:  0.8492581094889247
test:  0.8072747183979975
val:  0.8145440251572327
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 4096 --sizes 1 1 --standardize
2020-09-16 17:07:56.833607: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:07:56.833629: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
Traceback (most recent call last):
  File "ranknet.py", line 572, in <module>
    bg = BatchGenerator(train_x, train_y, args.batch_size)
  File "ranknet.py", line 34, in __init__
    self.x1_indices, self.x2_indices, self.y_trans = self._transform_pairwise(
  File "ranknet.py", line 49, in _transform_pairwise
    if (np.abs(self.y[i] - self.y[j]) <= self.delta):
IndexError: index 3040 is out of bounds for axis 0 with size 3040
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e2 -b 4096 --sizes 1 1 --standardize
2020-09-16 17:08:30.739570: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:08:30.739597: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:08:32.451401: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:08:32.455534: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:08:32.455931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:08:32.456016: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:08:32.456085: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:08:32.456962: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:08:32.457170: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:08:32.459292: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:08:32.459390: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:08:32.459460: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:08:32.459469: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:08:32.459712: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:08:32.464549: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:08:32.464935: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cc44398fc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:08:32.464961: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:08:32.466135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:08:32.466145: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/2
12/12 [==============================] - 0s 13ms/step - loss: 0.7266 - val_loss: 0.6284
Epoch 2/2
12/12 [==============================] - 0s 6ms/step - loss: 0.6492 - val_loss: 0.5956
train:  0.6718118408063595
test:  0.656311013767209
val:  0.6566823899371069
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 10 -b 4096 --sizes 1 1 --standardize
2020-09-16 17:09:02.683137: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:02.683160: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:09:04.679080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:09:04.683156: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:09:04.683589: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:09:04.683675: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:04.683747: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:04.684574: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:09:04.684790: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:09:04.686904: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:09:04.687007: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:04.687080: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:09:04.687101: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:09:04.687337: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:09:04.693034: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:09:04.693349: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55923d14d7f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:09:04.693364: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:09:04.694384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:09:04.694393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/2
12/12 [==============================] - 0s 16ms/step - loss: 0.6827 - val_loss: 0.6730
Epoch 2/2
12/12 [==============================] - 0s 8ms/step - loss: 0.6507 - val_loss: 0.6349
train:  0.7340789040716302
test:  0.7042083854818523
val:  0.704559748427673
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 10 -b 4096 --sizes 1 1 --standardize
2020-09-16 17:09:23.011111: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:23.011134: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:09:24.701728: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:09:24.705901: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:09:24.706302: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:09:24.706385: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:24.706453: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:24.707321: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:09:24.707535: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:09:24.709576: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:09:24.709671: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:24.709739: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:09:24.709747: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:09:24.710019: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:09:24.714976: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:09:24.715390: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5606c4b8f640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:09:24.715404: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:09:24.716497: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:09:24.716507: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/10
6/6 [==============================] - 0s 23ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 2/10
6/6 [==============================] - 0s 13ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 3/10
6/6 [==============================] - 0s 13ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 4/10
6/6 [==============================] - 0s 11ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 5/10
6/6 [==============================] - 0s 12ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 6/10
6/6 [==============================] - 0s 12ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 7/10
6/6 [==============================] - 0s 11ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 8/10
6/6 [==============================] - 0s 13ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 9/10
6/6 [==============================] - 0s 11ms/step - loss: 0.6931 - val_loss: 0.6931
Epoch 10/10
6/6 [==============================] - 0s 11ms/step - loss: 0.6931 - val_loss: 0.6931
train:  1.0
test:  1.0
val:  1.0
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 10 -b 20000 --sizes 10 10 --standardize
2020-09-16 17:09:57.669671: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:57.669696: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:09:59.362430: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:09:59.366499: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:09:59.366924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:09:59.366994: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:09:59.367049: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:59.367950: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:09:59.368172: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:09:59.370233: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:09:59.370318: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:09:59.370373: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:09:59.370382: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:09:59.370602: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:09:59.375663: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:09:59.376009: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55988b551c60 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:09:59.376026: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:09:59.377137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:09:59.377148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/10
2/2 [==============================] - 0s 48ms/step - loss: 0.7703 - val_loss: 0.7462
Epoch 2/10
2/2 [==============================] - 0s 15ms/step - loss: 0.7432 - val_loss: 0.7261
Epoch 3/10
2/2 [==============================] - 0s 45ms/step - loss: 0.7121 - val_loss: 0.7081
Epoch 4/10
2/2 [==============================] - 0s 14ms/step - loss: 0.6982 - val_loss: 0.6918
Epoch 5/10
2/2 [==============================] - 0s 40ms/step - loss: 0.6738 - val_loss: 0.6767
Epoch 6/10
2/2 [==============================] - 0s 13ms/step - loss: 0.6628 - val_loss: 0.6626
Epoch 7/10
2/2 [==============================] - 0s 13ms/step - loss: 0.6480 - val_loss: 0.6499
Epoch 8/10
2/2 [==============================] - 0s 53ms/step - loss: 0.6308 - val_loss: 0.6391
Epoch 9/10
2/2 [==============================] - 0s 13ms/step - loss: 0.6231 - val_loss: 0.6292
Epoch 10/10
2/2 [==============================] - 0s 32ms/step - loss: 0.6091 - val_loss: 0.6197
train:  0.6732990855717774
test:  0.6771526908635794
val:  0.6474842767295598
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 10 -b 40000 --sizes 10 10 --standardize
2020-09-16 17:10:23.483837: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:10:23.483859: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:10:25.170769: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:10:25.174824: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:10:25.175216: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:10:25.175304: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:10:25.175386: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:10:25.176239: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:10:25.176455: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:10:25.178508: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:10:25.178616: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:10:25.178694: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:10:25.178715: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:10:25.178964: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:10:25.183970: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:10:25.184385: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558df8ff08d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:10:25.184401: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:10:25.186056: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:10:25.186068: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/10
1/1 [==============================] - 0s 97ms/step - loss: 0.7664 - val_loss: 0.7605
Epoch 2/10
1/1 [==============================] - 0s 21ms/step - loss: 0.7537 - val_loss: 0.7468
Epoch 3/10
1/1 [==============================] - 0s 24ms/step - loss: 0.7416 - val_loss: 0.7341
Epoch 4/10
1/1 [==============================] - 0s 23ms/step - loss: 0.7303 - val_loss: 0.7210
Epoch 5/10
1/1 [==============================] - 0s 22ms/step - loss: 0.7197 - val_loss: 0.7087
Epoch 6/10
1/1 [==============================] - 0s 23ms/step - loss: 0.7097 - val_loss: 0.6969
Epoch 7/10
1/1 [==============================] - 0s 22ms/step - loss: 0.7003 - val_loss: 0.6857
Epoch 8/10
1/1 [==============================] - 0s 22ms/step - loss: 0.6914 - val_loss: 0.6755
Epoch 9/10
1/1 [==============================] - 0s 29ms/step - loss: 0.6829 - val_loss: 0.6662
Epoch 10/10
1/1 [==============================] - 0s 28ms/step - loss: 0.6746 - val_loss: 0.6568
train:  0.5990855717774198
test:  0.584217772215269
val:  0.6216981132075472
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 10 -b 40000 --sizes 10 10 --standardize
2020-09-16 17:11:03.969301: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:11:03.969328: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:11:06.207617: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:11:06.211688: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:11:06.212085: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:11:06.212167: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:11:06.212234: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:11:06.213102: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:11:06.213341: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:11:06.215260: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:11:06.215363: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:11:06.215431: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:11:06.215439: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:11:06.215682: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:11:06.220131: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:11:06.220399: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c1a018b840 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:11:06.220424: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:11:06.221447: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:11:06.221458: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/10
7/7 [==============================] - 1s 72ms/step - loss: 0.7322 - val_loss: 0.6908
Epoch 2/10
7/7 [==============================] - 0s 60ms/step - loss: 0.6438 - val_loss: 0.6117
Epoch 3/10
7/7 [==============================] - 0s 55ms/step - loss: 0.5904 - val_loss: 0.5553
Epoch 4/10
7/7 [==============================] - 0s 52ms/step - loss: 0.5529 - val_loss: 0.5145
Epoch 5/10
7/7 [==============================] - 0s 60ms/step - loss: 0.5232 - val_loss: 0.4872
Epoch 6/10
7/7 [==============================] - 0s 59ms/step - loss: 0.5046 - val_loss: 0.4694
Epoch 7/10
7/7 [==============================] - 0s 70ms/step - loss: 0.4872 - val_loss: 0.4571
Epoch 8/10
7/7 [==============================] - 0s 68ms/step - loss: 0.4745 - val_loss: 0.4477
Epoch 9/10
7/7 [==============================] - 0s 57ms/step - loss: 0.4626 - val_loss: 0.4371
Epoch 10/10
7/7 [==============================] - 0s 60ms/step - loss: 0.4520 - val_loss: 0.4265
train:  0.7881321331462912
test:  0.7564080100125157
val:  0.8006289308176101
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 30 -b 1_000_000 --sizes 10 10 --standardize
2020-09-16 17:11:52.015991: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:11:52.016017: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:11:54.242295: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:11:54.246452: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:11:54.246927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:11:54.246992: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:11:54.247043: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:11:54.247861: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:11:54.248058: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:11:54.250026: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:11:54.250103: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:11:54.250154: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:11:54.250163: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:11:54.250382: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:11:54.254804: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:11:54.255108: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562d0ad874d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:11:54.255124: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:11:54.256095: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:11:54.256105: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/30
1/1 [==============================] - 0s 112ms/step - loss: 0.7927 - val_loss: 0.7953
Epoch 2/30
1/1 [==============================] - 0s 27ms/step - loss: 0.7749 - val_loss: 0.7780
Epoch 3/30
1/1 [==============================] - 0s 28ms/step - loss: 0.7583 - val_loss: 0.7614
Epoch 4/30
1/1 [==============================] - 0s 28ms/step - loss: 0.7427 - val_loss: 0.7460
Epoch 5/30
1/1 [==============================] - 0s 28ms/step - loss: 0.7284 - val_loss: 0.7312
Epoch 6/30
1/1 [==============================] - 0s 27ms/step - loss: 0.7151 - val_loss: 0.7172
Epoch 7/30
1/1 [==============================] - 0s 27ms/step - loss: 0.7028 - val_loss: 0.7044
Epoch 8/30
1/1 [==============================] - 0s 26ms/step - loss: 0.6913 - val_loss: 0.6924
Epoch 9/30
1/1 [==============================] - 0s 32ms/step - loss: 0.6807 - val_loss: 0.6814
Epoch 10/30
1/1 [==============================] - 0s 25ms/step - loss: 0.6707 - val_loss: 0.6711
Epoch 11/30
1/1 [==============================] - 0s 26ms/step - loss: 0.6615 - val_loss: 0.6617
Epoch 12/30
1/1 [==============================] - 0s 30ms/step - loss: 0.6529 - val_loss: 0.6530
Epoch 13/30
1/1 [==============================] - 0s 27ms/step - loss: 0.6448 - val_loss: 0.6449
Epoch 14/30
1/1 [==============================] - 0s 26ms/step - loss: 0.6372 - val_loss: 0.6373
Epoch 15/30
1/1 [==============================] - 0s 27ms/step - loss: 0.6300 - val_loss: 0.6301
Epoch 16/30
1/1 [==============================] - 0s 27ms/step - loss: 0.6232 - val_loss: 0.6229
Epoch 17/30
1/1 [==============================] - 0s 26ms/step - loss: 0.6168 - val_loss: 0.6161
Epoch 18/30
1/1 [==============================] - 0s 29ms/step - loss: 0.6107 - val_loss: 0.6095
Epoch 19/30
1/1 [==============================] - 0s 26ms/step - loss: 0.6048 - val_loss: 0.6033
Epoch 20/30
1/1 [==============================] - 0s 26ms/step - loss: 0.5992 - val_loss: 0.5973
Epoch 21/30
1/1 [==============================] - 0s 27ms/step - loss: 0.5937 - val_loss: 0.5917
Epoch 22/30
1/1 [==============================] - 0s 27ms/step - loss: 0.5885 - val_loss: 0.5861
Epoch 23/30
1/1 [==============================] - 0s 26ms/step - loss: 0.5835 - val_loss: 0.5807
Epoch 24/30
1/1 [==============================] - 0s 26ms/step - loss: 0.5786 - val_loss: 0.5754
Epoch 25/30
1/1 [==============================] - 0s 27ms/step - loss: 0.5740 - val_loss: 0.5702
Epoch 26/30
1/1 [==============================] - 0s 27ms/step - loss: 0.5695 - val_loss: 0.5653
Epoch 27/30
1/1 [==============================] - 0s 28ms/step - loss: 0.5652 - val_loss: 0.5605
Epoch 28/30
1/1 [==============================] - 0s 27ms/step - loss: 0.5611 - val_loss: 0.5559
Epoch 29/30
1/1 [==============================] - 0s 28ms/step - loss: 0.5572 - val_loss: 0.5515
Epoch 30/30
1/1 [==============================] - 0s 30ms/step - loss: 0.5534 - val_loss: 0.5474
train:  0.7202960201589859
test:  0.7192897371714644
val:  0.7400943396226415
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 30 -b 4096 --sizes 10 10 --standardize
2020-09-16 17:12:29.289436: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:12:29.289464: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:12:31.585403: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:12:31.593250: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:12:31.593947: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:12:31.594084: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:12:31.594165: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:12:31.595450: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:12:31.595801: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:12:31.598577: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:12:31.598821: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:12:31.598922: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:12:31.598945: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:12:31.599255: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:12:31.606024: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:12:31.606424: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55eb1e86e7b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:12:31.606450: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:12:31.608098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:12:31.608113: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/30
61/61 [==============================] - 1s 11ms/step - loss: 0.6059 - val_loss: 0.5476
Epoch 2/30
61/61 [==============================] - 1s 10ms/step - loss: 0.4509 - val_loss: 0.4908
Epoch 3/30
61/61 [==============================] - 1s 10ms/step - loss: 0.3953 - val_loss: 0.4642
Epoch 4/30
61/61 [==============================] - 1s 9ms/step - loss: 0.3628 - val_loss: 0.4603
Epoch 5/30
61/61 [==============================] - 1s 10ms/step - loss: 0.3448 - val_loss: 0.4632
Epoch 6/30
61/61 [==============================] - 1s 10ms/step - loss: 0.3326 - val_loss: 0.4710
Epoch 7/30
61/61 [==============================] - 1s 10ms/step - loss: 0.3230 - val_loss: 0.4707
Epoch 8/30
61/61 [==============================] - 1s 10ms/step - loss: 0.3148 - val_loss: 0.4780
Epoch 9/30
61/61 [==============================] - 1s 9ms/step - loss: 0.3078 - val_loss: 0.4757
Epoch 10/30
61/61 [==============================] - 1s 9ms/step - loss: 0.3015 - val_loss: 0.4746
Epoch 11/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2959 - val_loss: 0.4873
Epoch 12/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2911 - val_loss: 0.4848
Epoch 13/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2866 - val_loss: 0.4900
Epoch 14/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2826 - val_loss: 0.4865
Epoch 15/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2791 - val_loss: 0.4776
Epoch 16/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2763 - val_loss: 0.4898
Epoch 17/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2732 - val_loss: 0.4916
Epoch 18/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2706 - val_loss: 0.4874
Epoch 19/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2687 - val_loss: 0.4746
Epoch 20/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2662 - val_loss: 0.4915
Epoch 21/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2639 - val_loss: 0.4885
Epoch 22/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2624 - val_loss: 0.4996
Epoch 23/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2603 - val_loss: 0.5072
Epoch 24/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2587 - val_loss: 0.5026
Epoch 25/30
61/61 [==============================] - 1s 9ms/step - loss: 0.2568 - val_loss: 0.5138
Epoch 26/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2553 - val_loss: 0.5204
Epoch 27/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2538 - val_loss: 0.5293
Epoch 28/30
61/61 [==============================] - 1s 11ms/step - loss: 0.2524 - val_loss: 0.5349
Epoch 29/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2512 - val_loss: 0.5299
Epoch 30/30
61/61 [==============================] - 1s 10ms/step - loss: 0.2503 - val_loss: 0.5518
train:  0.8889956876396321
test:  0.8180632040050062
val:  0.7852987421383648
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 100 -b 1_000_000 --sizes 10 10 --standardize
2020-09-16 17:13:26.926722: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:13:26.926748: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:13:29.156368: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:13:29.160606: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:13:29.161009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:13:29.161092: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:13:29.161160: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:13:29.162016: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:13:29.162236: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:13:29.164002: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:13:29.164092: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:13:29.164160: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:13:29.164168: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:13:29.164408: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:13:29.168899: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:13:29.169256: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5eaed3280 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:13:29.169284: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:13:29.170454: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:13:29.170467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/100
1/1 [==============================] - 0s 107ms/step - loss: 0.8022 - val_loss: 0.7765
Epoch 2/100
1/1 [==============================] - 0s 26ms/step - loss: 0.7875 - val_loss: 0.7629
Epoch 3/100
1/1 [==============================] - 0s 25ms/step - loss: 0.7735 - val_loss: 0.7497
Epoch 4/100
1/1 [==============================] - 0s 26ms/step - loss: 0.7601 - val_loss: 0.7369
Epoch 5/100
1/1 [==============================] - 0s 25ms/step - loss: 0.7472 - val_loss: 0.7248
Epoch 6/100
1/1 [==============================] - 0s 30ms/step - loss: 0.7350 - val_loss: 0.7133
Epoch 7/100
1/1 [==============================] - 0s 31ms/step - loss: 0.7234 - val_loss: 0.7021
Epoch 8/100
1/1 [==============================] - 0s 25ms/step - loss: 0.7123 - val_loss: 0.6913
Epoch 9/100
1/1 [==============================] - 0s 29ms/step - loss: 0.7018 - val_loss: 0.6812
Epoch 10/100
1/1 [==============================] - 0s 32ms/step - loss: 0.6918 - val_loss: 0.6719
Epoch 11/100
1/1 [==============================] - 0s 26ms/step - loss: 0.6823 - val_loss: 0.6631
Epoch 12/100
1/1 [==============================] - 0s 30ms/step - loss: 0.6734 - val_loss: 0.6546
Epoch 13/100
1/1 [==============================] - 0s 25ms/step - loss: 0.6649 - val_loss: 0.6460
Epoch 14/100
1/1 [==============================] - 0s 30ms/step - loss: 0.6569 - val_loss: 0.6379
Epoch 15/100
1/1 [==============================] - 0s 27ms/step - loss: 0.6494 - val_loss: 0.6303
Epoch 16/100
1/1 [==============================] - 0s 25ms/step - loss: 0.6424 - val_loss: 0.6232
Epoch 17/100
1/1 [==============================] - 0s 26ms/step - loss: 0.6358 - val_loss: 0.6167
Epoch 18/100
1/1 [==============================] - 0s 29ms/step - loss: 0.6296 - val_loss: 0.6105
Epoch 19/100
1/1 [==============================] - 0s 30ms/step - loss: 0.6237 - val_loss: 0.6048
Epoch 20/100
1/1 [==============================] - 0s 28ms/step - loss: 0.6181 - val_loss: 0.5994
Epoch 21/100
1/1 [==============================] - 0s 31ms/step - loss: 0.6128 - val_loss: 0.5944
Epoch 22/100
1/1 [==============================] - 0s 28ms/step - loss: 0.6078 - val_loss: 0.5895
Epoch 23/100
1/1 [==============================] - 0s 28ms/step - loss: 0.6030 - val_loss: 0.5851
Epoch 24/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5985 - val_loss: 0.5807
Epoch 25/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5941 - val_loss: 0.5764
Epoch 26/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5899 - val_loss: 0.5722
Epoch 27/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5859 - val_loss: 0.5683
Epoch 28/100
1/1 [==============================] - 0s 31ms/step - loss: 0.5821 - val_loss: 0.5644
Epoch 29/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5785 - val_loss: 0.5605
Epoch 30/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5750 - val_loss: 0.5569
Epoch 31/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5716 - val_loss: 0.5533
Epoch 32/100
1/1 [==============================] - 0s 32ms/step - loss: 0.5682 - val_loss: 0.5498
Epoch 33/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5650 - val_loss: 0.5463
Epoch 34/100
1/1 [==============================] - 0s 29ms/step - loss: 0.5619 - val_loss: 0.5429
Epoch 35/100
1/1 [==============================] - 0s 30ms/step - loss: 0.5588 - val_loss: 0.5396
Epoch 36/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5558 - val_loss: 0.5363
Epoch 37/100
1/1 [==============================] - 0s 29ms/step - loss: 0.5530 - val_loss: 0.5332
Epoch 38/100
1/1 [==============================] - 0s 28ms/step - loss: 0.5502 - val_loss: 0.5302
Epoch 39/100
1/1 [==============================] - 0s 30ms/step - loss: 0.5474 - val_loss: 0.5272
Epoch 40/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5447 - val_loss: 0.5245
Epoch 41/100
1/1 [==============================] - 0s 29ms/step - loss: 0.5421 - val_loss: 0.5218
Epoch 42/100
1/1 [==============================] - 0s 25ms/step - loss: 0.5395 - val_loss: 0.5192
Epoch 43/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5370 - val_loss: 0.5167
Epoch 44/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5345 - val_loss: 0.5143
Epoch 45/100
1/1 [==============================] - 0s 30ms/step - loss: 0.5321 - val_loss: 0.5120
Epoch 46/100
1/1 [==============================] - 0s 31ms/step - loss: 0.5297 - val_loss: 0.5097
Epoch 47/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5274 - val_loss: 0.5074
Epoch 48/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5251 - val_loss: 0.5052
Epoch 49/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5228 - val_loss: 0.5031
Epoch 50/100
1/1 [==============================] - 0s 29ms/step - loss: 0.5206 - val_loss: 0.5009
Epoch 51/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5184 - val_loss: 0.4988
Epoch 52/100
1/1 [==============================] - 0s 28ms/step - loss: 0.5163 - val_loss: 0.4967
Epoch 53/100
1/1 [==============================] - 0s 28ms/step - loss: 0.5142 - val_loss: 0.4946
Epoch 54/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5121 - val_loss: 0.4926
Epoch 55/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5101 - val_loss: 0.4906
Epoch 56/100
1/1 [==============================] - 0s 30ms/step - loss: 0.5080 - val_loss: 0.4887
Epoch 57/100
1/1 [==============================] - 0s 30ms/step - loss: 0.5061 - val_loss: 0.4867
Epoch 58/100
1/1 [==============================] - 0s 27ms/step - loss: 0.5041 - val_loss: 0.4848
Epoch 59/100
1/1 [==============================] - 0s 26ms/step - loss: 0.5022 - val_loss: 0.4829
Epoch 60/100
1/1 [==============================] - 0s 29ms/step - loss: 0.5003 - val_loss: 0.4810
Epoch 61/100
1/1 [==============================] - 0s 25ms/step - loss: 0.4984 - val_loss: 0.4792
Epoch 62/100
1/1 [==============================] - 0s 30ms/step - loss: 0.4966 - val_loss: 0.4773
Epoch 63/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4947 - val_loss: 0.4755
Epoch 64/100
1/1 [==============================] - 0s 30ms/step - loss: 0.4929 - val_loss: 0.4737
Epoch 65/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4911 - val_loss: 0.4720
Epoch 66/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4894 - val_loss: 0.4703
Epoch 67/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4877 - val_loss: 0.4686
Epoch 68/100
1/1 [==============================] - 0s 25ms/step - loss: 0.4860 - val_loss: 0.4670
Epoch 69/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4843 - val_loss: 0.4654
Epoch 70/100
1/1 [==============================] - 0s 27ms/step - loss: 0.4826 - val_loss: 0.4638
Epoch 71/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4810 - val_loss: 0.4622
Epoch 72/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4794 - val_loss: 0.4607
Epoch 73/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4779 - val_loss: 0.4592
Epoch 74/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4763 - val_loss: 0.4577
Epoch 75/100
1/1 [==============================] - 0s 25ms/step - loss: 0.4748 - val_loss: 0.4563
Epoch 76/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4732 - val_loss: 0.4549
Epoch 77/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4717 - val_loss: 0.4535
Epoch 78/100
1/1 [==============================] - 0s 28ms/step - loss: 0.4702 - val_loss: 0.4522
Epoch 79/100
1/1 [==============================] - 0s 30ms/step - loss: 0.4688 - val_loss: 0.4509
Epoch 80/100
1/1 [==============================] - 0s 38ms/step - loss: 0.4673 - val_loss: 0.4497
Epoch 81/100
1/1 [==============================] - 0s 37ms/step - loss: 0.4659 - val_loss: 0.4484
Epoch 82/100
1/1 [==============================] - 0s 32ms/step - loss: 0.4644 - val_loss: 0.4472
Epoch 83/100
1/1 [==============================] - 0s 46ms/step - loss: 0.4630 - val_loss: 0.4460
Epoch 84/100
1/1 [==============================] - 0s 37ms/step - loss: 0.4616 - val_loss: 0.4448
Epoch 85/100
1/1 [==============================] - 0s 37ms/step - loss: 0.4602 - val_loss: 0.4437
Epoch 86/100
1/1 [==============================] - 0s 40ms/step - loss: 0.4588 - val_loss: 0.4425
Epoch 87/100
1/1 [==============================] - 0s 38ms/step - loss: 0.4574 - val_loss: 0.4414
Epoch 88/100
1/1 [==============================] - 0s 31ms/step - loss: 0.4560 - val_loss: 0.4403
Epoch 89/100
1/1 [==============================] - 0s 35ms/step - loss: 0.4547 - val_loss: 0.4392
Epoch 90/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4533 - val_loss: 0.4382
Epoch 91/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4520 - val_loss: 0.4371
Epoch 92/100
1/1 [==============================] - 0s 29ms/step - loss: 0.4507 - val_loss: 0.4361
Epoch 93/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4494 - val_loss: 0.4351
Epoch 94/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4481 - val_loss: 0.4341
Epoch 95/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4468 - val_loss: 0.4331
Epoch 96/100
1/1 [==============================] - 0s 30ms/step - loss: 0.4455 - val_loss: 0.4322
Epoch 97/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4443 - val_loss: 0.4313
Epoch 98/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4431 - val_loss: 0.4305
Epoch 99/100
1/1 [==============================] - 0s 26ms/step - loss: 0.4418 - val_loss: 0.4296
Epoch 100/100
1/1 [==============================] - 0s 32ms/step - loss: 0.4406 - val_loss: 0.4288
train:  0.7965481633501325
test:  0.7702596996245307
val:  0.7985849056603773
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 20 -b 20_000 --sizes 10 10 --standardize
2020-09-16 17:15:51.181547: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:15:51.181574: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:15:53.396633: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:15:53.400694: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:15:53.401079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:15:53.401144: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:15:53.401194: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:15:53.402080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:15:53.402373: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:15:53.404298: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:15:53.404390: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:15:53.404440: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:15:53.404450: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:15:53.404671: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:15:53.409184: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:15:53.409560: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564490a14c40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:15:53.409576: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:15:53.410784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:15:53.410796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/20
13/13 [==============================] - 1s 41ms/step - loss: 0.6585 - val_loss: 0.6273
Epoch 2/20
13/13 [==============================] - 0s 33ms/step - loss: 0.6017 - val_loss: 0.5873
Epoch 3/20
13/13 [==============================] - 0s 34ms/step - loss: 0.5532 - val_loss: 0.5423
Epoch 4/20
13/13 [==============================] - 0s 33ms/step - loss: 0.5131 - val_loss: 0.5117
Epoch 5/20
13/13 [==============================] - 0s 31ms/step - loss: 0.4819 - val_loss: 0.4877
Epoch 6/20
13/13 [==============================] - 0s 31ms/step - loss: 0.4552 - val_loss: 0.4703
Epoch 7/20
13/13 [==============================] - 0s 31ms/step - loss: 0.4340 - val_loss: 0.4614
Epoch 8/20
13/13 [==============================] - 0s 33ms/step - loss: 0.4152 - val_loss: 0.4543
Epoch 9/20
13/13 [==============================] - 0s 29ms/step - loss: 0.3999 - val_loss: 0.4482
Epoch 10/20
13/13 [==============================] - 0s 31ms/step - loss: 0.3864 - val_loss: 0.4431
Epoch 11/20
13/13 [==============================] - 0s 31ms/step - loss: 0.3758 - val_loss: 0.4388
Epoch 12/20
13/13 [==============================] - 0s 30ms/step - loss: 0.3666 - val_loss: 0.4336
Epoch 13/20
13/13 [==============================] - 0s 34ms/step - loss: 0.3588 - val_loss: 0.4323
Epoch 14/20
13/13 [==============================] - 0s 31ms/step - loss: 0.3517 - val_loss: 0.4297
Epoch 15/20
13/13 [==============================] - 0s 32ms/step - loss: 0.3455 - val_loss: 0.4298
Epoch 16/20
13/13 [==============================] - 0s 32ms/step - loss: 0.3397 - val_loss: 0.4302
Epoch 17/20
13/13 [==============================] - 0s 31ms/step - loss: 0.3346 - val_loss: 0.4291
Epoch 18/20
13/13 [==============================] - 0s 29ms/step - loss: 0.3301 - val_loss: 0.4306
Epoch 19/20
13/13 [==============================] - 0s 31ms/step - loss: 0.3260 - val_loss: 0.4317
Epoch 20/20
13/13 [==============================] - 0s 30ms/step - loss: 0.3221 - val_loss: 0.4337
train:  0.8561000848617101
test:  0.8125125156445557
val:  0.8157232704402516
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 15 -b 20_000 --sizes 50 50 --standardize
2020-09-16 17:18:55.544834: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:18:55.544859: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:18:57.773377: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:18:57.777485: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:18:57.777906: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:18:57.777991: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:18:57.778062: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:18:57.779036: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:18:57.779256: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:18:57.781082: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:18:57.781179: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:18:57.781250: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:18:57.781258: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:18:57.781502: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:18:57.786172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:18:57.786511: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5596199e6d00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:18:57.786525: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:18:57.787494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:18:57.787505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/15
13/13 [==============================] - 1s 48ms/step - loss: 0.5972 - val_loss: 0.5053
Epoch 2/15
13/13 [==============================] - 1s 46ms/step - loss: 0.4704 - val_loss: 0.4577
Epoch 3/15
13/13 [==============================] - 1s 46ms/step - loss: 0.4162 - val_loss: 0.4195
Epoch 4/15
13/13 [==============================] - 1s 45ms/step - loss: 0.3801 - val_loss: 0.3945
Epoch 5/15
13/13 [==============================] - 1s 47ms/step - loss: 0.3522 - val_loss: 0.3757
Epoch 6/15
13/13 [==============================] - 1s 44ms/step - loss: 0.3318 - val_loss: 0.3658
Epoch 7/15
13/13 [==============================] - 1s 46ms/step - loss: 0.3145 - val_loss: 0.3607
Epoch 8/15
13/13 [==============================] - 1s 48ms/step - loss: 0.2998 - val_loss: 0.3627
Epoch 9/15
13/13 [==============================] - 1s 44ms/step - loss: 0.2861 - val_loss: 0.3644
Epoch 10/15
13/13 [==============================] - 1s 45ms/step - loss: 0.2741 - val_loss: 0.3647
Epoch 11/15
13/13 [==============================] - 1s 45ms/step - loss: 0.2636 - val_loss: 0.3709
Epoch 12/15
13/13 [==============================] - 1s 45ms/step - loss: 0.2534 - val_loss: 0.3788
Epoch 13/15
13/13 [==============================] - 1s 41ms/step - loss: 0.2441 - val_loss: 0.3824
Epoch 14/15
13/13 [==============================] - 1s 45ms/step - loss: 0.2355 - val_loss: 0.3928
Epoch 15/15
13/13 [==============================] - 1s 42ms/step - loss: 0.2271 - val_loss: 0.3938
train:  0.9034078904071631
test:  0.8214236545682103
val:  0.8330188679245283
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 8 -b 20_000 --sizes 50 50 --standardize
2020-09-16 17:19:24.975327: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:19:24.975354: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:19:27.190153: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:19:27.194311: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:19:27.194731: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:19:27.194799: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:19:27.194850: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:19:27.195766: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:19:27.195989: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:19:27.197765: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:19:27.197881: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:19:27.197952: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:19:27.197971: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:19:27.198204: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:19:27.202591: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:19:27.202912: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563d0a36dfc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:19:27.202938: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:19:27.204086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:19:27.204100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
13/13 [==============================] - 1s 51ms/step - loss: 0.6124 - val_loss: 0.5367
Epoch 2/8
13/13 [==============================] - 1s 44ms/step - loss: 0.4795 - val_loss: 0.4812
Epoch 3/8
13/13 [==============================] - 1s 43ms/step - loss: 0.4278 - val_loss: 0.4507
Epoch 4/8
13/13 [==============================] - 1s 44ms/step - loss: 0.3919 - val_loss: 0.4324
Epoch 5/8
13/13 [==============================] - 1s 42ms/step - loss: 0.3654 - val_loss: 0.4269
Epoch 6/8
13/13 [==============================] - 1s 44ms/step - loss: 0.3444 - val_loss: 0.4212
Epoch 7/8
13/13 [==============================] - 1s 44ms/step - loss: 0.3267 - val_loss: 0.4198
Epoch 8/8
13/13 [==============================] - 1s 41ms/step - loss: 0.3120 - val_loss: 0.4204
train:  0.8640941878387974
test:  0.8299061326658322
val:  0.8064465408805032
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 8 -b 20_000 --sizes 100 100 --standardize
2020-09-16 17:19:42.408853: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:19:42.408874: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:19:44.643132: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:19:44.647307: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:19:44.647688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:19:44.647750: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:19:44.647797: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:19:44.648652: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:19:44.648871: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:19:44.650874: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:19:44.651012: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:19:44.651064: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:19:44.651072: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:19:44.651307: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:19:44.655953: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:19:44.656291: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b87545c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:19:44.656304: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:19:44.657319: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:19:44.657330: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
13/13 [==============================] - 1s 68ms/step - loss: 0.5275 - val_loss: 0.4620
Epoch 2/8
13/13 [==============================] - 1s 58ms/step - loss: 0.4065 - val_loss: 0.4242
Epoch 3/8
13/13 [==============================] - 1s 65ms/step - loss: 0.3556 - val_loss: 0.4062
Epoch 4/8
13/13 [==============================] - 1s 60ms/step - loss: 0.3225 - val_loss: 0.3995
Epoch 5/8
13/13 [==============================] - 1s 55ms/step - loss: 0.2973 - val_loss: 0.3973
Epoch 6/8
13/13 [==============================] - 1s 59ms/step - loss: 0.2753 - val_loss: 0.3923
Epoch 7/8
13/13 [==============================] - 1s 59ms/step - loss: 0.2567 - val_loss: 0.3914
Epoch 8/8
13/13 [==============================] - 1s 58ms/step - loss: 0.2407 - val_loss: 0.4034
train:  0.9010547098249078
test:  0.8192772215269086
val:  0.822248427672956
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 8 -b 40_000 --sizes 200 200 --standardize
2020-09-16 17:20:10.881540: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:20:10.881565: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2020-09-16 17:20:13.122672: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:20:13.126882: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:20:13.127259: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:20:13.127324: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:20:13.127375: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:20:13.128238: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:20:13.128440: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:20:13.130191: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:20:13.130288: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:20:13.130338: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:20:13.130348: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:20:13.130624: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:20:13.135299: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:20:13.135659: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x560be845f650 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:20:13.135681: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:20:13.136691: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:20:13.136701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
7/7 [==============================] - 1s 159ms/step - loss: 0.5967 - val_loss: 0.4993
Epoch 2/8
7/7 [==============================] - 1s 146ms/step - loss: 0.4403 - val_loss: 0.4508
Epoch 3/8
7/7 [==============================] - 1s 173ms/step - loss: 0.3908 - val_loss: 0.4107
Epoch 4/8
7/7 [==============================] - 1s 146ms/step - loss: 0.3563 - val_loss: 0.3910
Epoch 5/8
7/7 [==============================] - 1s 147ms/step - loss: 0.3298 - val_loss: 0.3746
Epoch 6/8
7/7 [==============================] - 1s 148ms/step - loss: 0.3063 - val_loss: 0.3713
Epoch 7/8
7/7 [==============================] - 1s 146ms/step - loss: 0.2864 - val_loss: 0.3660
Epoch 8/8
7/7 [==============================] - 1s 144ms/step - loss: 0.2683 - val_loss: 0.3654
train:  0.8865968289430387
test:  0.8286420525657071
val:  0.837814465408805
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 8 -b 40_000 --sizes 200 200 --standardize --reduce_features
2020-09-16 17:20:47.505434: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:20:47.505460: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
filtering Int64Index([9, 59, 72, 137, 138, 146, 147, 150, 152, 164, 165, 176, 182, 183,
            187, 189, 196],
           dtype='int64')
filtering Int64Index([ 96,  19,  36,   5,   6,   7,   8,  22,   0,   2, 136, 149,  27,
             28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:20:50.272157: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:20:50.276324: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:20:50.276730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:20:50.276795: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:20:50.276845: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:20:50.277691: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:20:50.277900: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:20:50.279608: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:20:50.279701: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:20:50.279771: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:20:50.279779: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:20:50.280068: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:20:50.284469: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:20:50.284760: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d4123903f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:20:50.284779: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:20:50.286021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:20:50.286047: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
7/7 [==============================] - 1s 177ms/step - loss: 0.5862 - val_loss: 0.4238
Epoch 2/8
7/7 [==============================] - 1s 160ms/step - loss: 0.4469 - val_loss: 0.3875
Epoch 3/8
7/7 [==============================] - 1s 167ms/step - loss: 0.3933 - val_loss: 0.3707
Epoch 4/8
7/7 [==============================] - 1s 165ms/step - loss: 0.3589 - val_loss: 0.3561
Epoch 5/8
7/7 [==============================] - 1s 164ms/step - loss: 0.3310 - val_loss: 0.3399
Epoch 6/8
7/7 [==============================] - 1s 161ms/step - loss: 0.3080 - val_loss: 0.3327
Epoch 7/8
7/7 [==============================] - 1s 162ms/step - loss: 0.2891 - val_loss: 0.3280
Epoch 8/8
7/7 [==============================] - 1s 192ms/step - loss: 0.2709 - val_loss: 0.3240
train:  0.8867018236608303
test:  0.8149280350438047
val:  0.8528301886792453
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t mordred -e 8 -b 40_000 --sizes 200 200 --standardize --reduce_features
2020-09-16 17:21:25.714790: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:21:25.714816: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
filtering Int64Index([  24,  736,  737,  738,  739,  740,  741,  749,  755,  757,
            ...
            1189, 1190, 1191, 1195, 1199, 1200, 1201, 1210, 1211, 1212],
           dtype='int64', length=137)
filtering Int64Index([1262,    9,  532,  545,  558,  571,  584,  597,  610,  623,
            ...
            1216, 1218, 1219, 1223, 1247, 1248, 1249, 1250, 1268, 1270],
           dtype='int64', length=658)
2020-09-16 17:21:58.948047: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:21:58.952034: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:21:58.952446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:21:58.952531: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:21:58.952599: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:21:58.953461: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:21:58.953668: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:21:58.955496: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:21:58.955671: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:21:58.955735: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:21:58.955744: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:21:58.956020: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:21:58.960900: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:21:58.961209: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55738d0625e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:21:58.961235: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:21:58.962462: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:21:58.962477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
7/7 [==============================] - 4s 543ms/step - loss: 0.5498 - val_loss: 0.5315
Epoch 2/8
7/7 [==============================] - 4s 518ms/step - loss: 0.4161 - val_loss: 0.4758
Epoch 3/8
7/7 [==============================] - 4s 521ms/step - loss: 0.3592 - val_loss: 0.4893
Epoch 4/8
7/7 [==============================] - 4s 511ms/step - loss: 0.3213 - val_loss: 0.4662
Epoch 5/8
7/7 [==============================] - 4s 510ms/step - loss: 0.2909 - val_loss: 0.4726
Epoch 6/8
7/7 [==============================] - 4s 507ms/step - loss: 0.2639 - val_loss: 0.4602
Epoch 7/8
7/7 [==============================] - 4s 506ms/step - loss: 0.2410 - val_loss: 0.4622
Epoch 8/8
7/7 [==============================] - 4s 507ms/step - loss: 0.2206 - val_loss: 0.4596
train:  0.9132481685457474
test:  0.7999092615769712
val:  0.8005503144654088
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 8 -b 40_000 --sizes 1000 1000 --standardize --reduce_features
2020-09-16 17:22:47.947102: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:22:47.947127: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
filtering Int64Index([9, 59, 72, 137, 138, 146, 148, 150, 152, 164, 165, 176, 182, 183,
            187, 189, 196],
           dtype='int64')
filtering Int64Index([ 96,  19,  36,   5,   6,   7,   8,  22,   0,   2, 136,  11,  12,
            149,  27,  28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:22:50.719150: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:22:50.723554: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:22:50.723949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:22:50.724037: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory
2020-09-16 17:22:50.724108: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:22:50.724959: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:22:50.725174: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:22:50.726987: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:22:50.727083: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory
2020-09-16 17:22:50.727166: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2020-09-16 17:22:50.727184: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2020-09-16 17:22:50.727426: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:22:50.731891: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:22:50.732233: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56327aed4510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:22:50.732259: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:22:50.733252: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:22:50.733273: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      
Epoch 1/8
7/7 [==============================] - 10s 1s/step - loss: 0.5098 - val_loss: 0.3829
Epoch 2/8
7/7 [==============================] - 11s 2s/step - loss: 0.3523 - val_loss: 0.3592
Epoch 3/8
7/7 [==============================] - 12s 2s/step - loss: 0.3025 - val_loss: 0.3337
Epoch 4/8
7/7 [==============================] - 10s 1s/step - loss: 0.2651 - val_loss: 0.3463
Epoch 5/8
7/7 [==============================] - 10s 1s/step - loss: 0.2348 - val_loss: 0.3295
Epoch 6/8
7/7 [==============================] - 10s 1s/step - loss: 0.2055 - val_loss: 0.3409
Epoch 7/8
7/7 [==============================] - 10s 1s/step - loss: 0.1820 - val_loss: 0.3555
Epoch 8/8
7/7 [==============================] - 10s 1s/step - loss: 0.1617 - val_loss: 0.3677
train:  0.9374276943592941
test:  0.8289893617021277
val:  0.8520440251572327
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --sizes 1000 1000 --standardize --reduce_features
2020-09-16 17:27:03.938171: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
filtering Int64Index([  9,  59,  72, 137, 138, 139, 146, 150, 152, 160, 164, 165, 176,
            182, 183, 187, 189, 196],
           dtype='int64')
filtering Int64Index([ 36,  96,   8,  19,   5,   6,   7,  22,   0,   2, 136,  11,  12,
            149,  27,  28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:27:06.853080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:27:06.857771: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.858166: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:27:06.858198: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:06.860308: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:27:06.861131: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:27:06.861379: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:27:06.863147: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:27:06.863675: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:27:06.863835: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:27:06.863938: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.864397: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.864764: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:27:06.865042: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:27:06.870472: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:27:06.870861: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561c5dbf77a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:27:06.870876: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:27:06.945378: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.945851: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561c5db6a710 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:27:06.945865: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070, Compute Capability 6.1
2020-09-16 17:27:06.946022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.946416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:27:06.946459: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:06.946525: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:27:06.946566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:27:06.946596: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:27:06.946626: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:27:06.946647: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:27:06.946687: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:27:06.946738: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.947143: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:06.947525: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:27:06.947583: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:07.254898: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:27:07.254930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-16 17:27:07.254936: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-16 17:27:07.255161: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:07.255593: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:07.255976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6921 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:02:00.0, compute capability: 6.1)
2020-09-16 17:27:07.256409: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Epoch 1/5
2020-09-16 17:27:07.917267: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
7/7 [==============================] - 1s 144ms/step - loss: 0.4857 - val_loss: 0.4298
Epoch 2/5
7/7 [==============================] - 1s 130ms/step - loss: 0.3494 - val_loss: 0.3986
Epoch 3/5
7/7 [==============================] - 1s 130ms/step - loss: 0.2978 - val_loss: 0.3908
Epoch 4/5
7/7 [==============================] - 1s 131ms/step - loss: 0.2602 - val_loss: 0.3799
Epoch 5/5
7/7 [==============================] - 1s 127ms/step - loss: 0.2286 - val_loss: 0.3793
train:  0.9089141597824769
test:  0.8330131414267835
val:  0.8419811320754716
 ~/Documents/Uni/RTpred/roi $ 
 ~/Documents/Uni/RTpred/roi $ 
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --sizes 5000 5000 --standardize --reduce_features
2020-09-16 17:27:39.362333: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
filtering Int64Index([  9,  59,  72, 137, 138, 146, 147, 148, 150, 152, 164, 165, 176,
            182, 183, 187, 189, 196],
           dtype='int64')
filtering Int64Index([ 96,  19,  36,   5,   6,   7,   8,  22,   0,   2, 136,  11,  12,
            149,  27,  28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:27:42.215577: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:27:42.219771: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.220174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:27:42.220196: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:42.222077: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:27:42.222862: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:27:42.223076: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:27:42.224880: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:27:42.225406: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:27:42.225557: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:27:42.225678: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.226133: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.226502: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:27:42.226830: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:27:42.231456: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:27:42.231815: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564629e8ee80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:27:42.231837: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:27:42.303566: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.304032: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564629e69090 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:27:42.304050: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070, Compute Capability 6.1
2020-09-16 17:27:42.304249: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.304629: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:27:42.304667: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:42.304714: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:27:42.304747: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:27:42.304777: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:27:42.304806: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:27:42.304834: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:27:42.304862: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:27:42.304933: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.305340: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.305695: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:27:42.305724: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:27:42.608747: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:27:42.608776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-16 17:27:42.608781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-16 17:27:42.608994: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.609406: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:27:42.609768: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6921 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:02:00.0, compute capability: 6.1)
2020-09-16 17:27:42.610249: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Epoch 1/5
2020-09-16 17:27:43.282737: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
7/7 [==============================] - 14s 2s/step - loss: 0.5958 - val_loss: 0.4691
Epoch 2/5
7/7 [==============================] - 15s 2s/step - loss: 0.3930 - val_loss: 0.4306
Epoch 3/5
7/7 [==============================] - 15s 2s/step - loss: 0.3471 - val_loss: 0.4338
Epoch 4/5
7/7 [==============================] - 15s 2s/step - loss: 0.3114 - val_loss: 0.4200
Epoch 5/5
7/7 [==============================] - 15s 2s/step - loss: 0.2776 - val_loss: 0.4208
train:  0.8853243362601964
test:  0.8466082603254067
val:  0.8239779874213836
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --sizes 10000 10000 --standardize --reduce_features
2020-09-16 17:29:25.384318: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
filtering Int64Index([9, 59, 72, 137, 138, 146, 148, 150, 152, 164, 165, 176, 182, 183,
            187, 189, 196],
           dtype='int64')
filtering Int64Index([ 96,  19,  36,   5,   6,   7,   8,  22,   0,   2, 136, 149,  27,
             28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:29:28.210035: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:29:28.214246: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.214640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:29:28.214671: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:28.216659: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:29:28.217468: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:29:28.217684: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:29:28.219399: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:29:28.219910: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:29:28.220067: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:29:28.220197: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.220649: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.221070: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:29:28.221363: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:29:28.226168: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:29:28.226432: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cfeaea43d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:29:28.226445: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:29:28.299948: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.300418: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cfeaa25950 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:29:28.300435: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070, Compute Capability 6.1
2020-09-16 17:29:28.300581: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.300954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:29:28.300986: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:28.301024: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:29:28.301045: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:29:28.301064: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:29:28.301084: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:29:28.301103: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:29:28.301123: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:29:28.301171: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.301564: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.301916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:29:28.301942: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:28.604553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:29:28.604582: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-16 17:29:28.604588: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-16 17:29:28.604816: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.605249: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:28.605632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6921 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:02:00.0, compute capability: 6.1)
2020-09-16 17:29:28.606118: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Epoch 1/5
2020-09-16 17:29:29.287010: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:29:39.534761: W tensorflow/core/common_runtime/bfc_allocator.cc:431] Allocator (GPU_0_bfc) ran out of memory trying to allocate 1.49GiB (rounded to 1600000000)requested by op functional_1/relu_layer1/MatMul_1
Current allocation summary follows.
2020-09-16 17:29:39.534789: I tensorflow/core/common_runtime/bfc_allocator.cc:970] BFCAllocator dump for GPU_0_bfc
2020-09-16 17:29:39.534800: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (256): 	Total Chunks: 31, Chunks in use: 30. 7.8KiB allocated for chunks. 7.5KiB in use in bin. 144B client-requested in use in bin.
2020-09-16 17:29:39.534810: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (512): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534819: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (1024): 	Total Chunks: 1, Chunks in use: 1. 1.2KiB allocated for chunks. 1.2KiB in use in bin. 1.0KiB client-requested in use in bin.
2020-09-16 17:29:39.534827: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (2048): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534834: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (4096): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534842: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (8192): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534849: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (16384): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534859: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (32768): 	Total Chunks: 10, Chunks in use: 9. 386.8KiB allocated for chunks. 353.5KiB in use in bin. 351.6KiB client-requested in use in bin.
2020-09-16 17:29:39.534867: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (65536): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534876: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (131072): 	Total Chunks: 3, Chunks in use: 2. 468.8KiB allocated for chunks. 312.5KiB in use in bin. 312.5KiB client-requested in use in bin.
2020-09-16 17:29:39.534883: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (262144): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534890: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (524288): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534896: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (1048576): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534903: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (2097152): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534912: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (4194304): 	Total Chunks: 4, Chunks in use: 3. 26.01MiB allocated for chunks. 20.14MiB in use in bin. 20.14MiB client-requested in use in bin.
2020-09-16 17:29:39.534920: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (8388608): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534929: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (16777216): 	Total Chunks: 2, Chunks in use: 2. 53.71MiB allocated for chunks. 53.71MiB in use in bin. 53.71MiB client-requested in use in bin.
2020-09-16 17:29:39.534936: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (33554432): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534944: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (67108864): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534951: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (134217728): 	Total Chunks: 0, Chunks in use: 0. 0B allocated for chunks. 0B in use in bin. 0B client-requested in use in bin.
2020-09-16 17:29:39.534959: I tensorflow/core/common_runtime/bfc_allocator.cc:977] Bin (268435456): 	Total Chunks: 8, Chunks in use: 6. 6.68GiB allocated for chunks. 5.59GiB in use in bin. 5.59GiB client-requested in use in bin.
2020-09-16 17:29:39.534967: I tensorflow/core/common_runtime/bfc_allocator.cc:993] Bin for 1.49GiB was 256.00MiB, Chunk State: 
2020-09-16 17:29:39.534980: I tensorflow/core/common_runtime/bfc_allocator.cc:999]   Size: 321.04MiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 26.86MiB | Requested Size: 26.86MiB | in_use: 1 | bin_num: -1, next:   Size: 381.47MiB | Requested Size: 381.47MiB | in_use: 1 | bin_num: -1
2020-09-16 17:29:39.534990: I tensorflow/core/common_runtime/bfc_allocator.cc:999]   Size: 797.91MiB | Requested Size: 0B | in_use: 0 | bin_num: 20, prev:   Size: 1.49GiB | Requested Size: 1.49GiB | in_use: 1 | bin_num: -1
2020-09-16 17:29:39.534997: I tensorflow/core/common_runtime/bfc_allocator.cc:1006] Next region of size 7257794816
2020-09-16 17:29:39.535005: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42000000 of size 1280 next 1
2020-09-16 17:29:39.535013: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42000500 of size 256 next 5
2020-09-16 17:29:39.535018: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42000600 of size 40192 next 8
2020-09-16 17:29:39.535025: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4200a300 of size 256 next 10
2020-09-16 17:29:39.535031: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4200a400 of size 256 next 11
2020-09-16 17:29:39.535037: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4200a500 of size 40192 next 9
2020-09-16 17:29:39.535042: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014200 of size 256 next 17
2020-09-16 17:29:39.535048: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014300 of size 256 next 20
2020-09-16 17:29:39.535054: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014400 of size 256 next 21
2020-09-16 17:29:39.535060: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014500 of size 256 next 22
2020-09-16 17:29:39.535066: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014600 of size 256 next 23
2020-09-16 17:29:39.535072: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014700 of size 256 next 24
2020-09-16 17:29:39.535077: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014800 of size 256 next 25
2020-09-16 17:29:39.535082: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014900 of size 256 next 26
2020-09-16 17:29:39.535088: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014a00 of size 256 next 27
2020-09-16 17:29:39.535093: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014b00 of size 256 next 28
2020-09-16 17:29:39.535099: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014c00 of size 256 next 29
2020-09-16 17:29:39.535104: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014d00 of size 256 next 33
2020-09-16 17:29:39.535110: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014e00 of size 256 next 39
2020-09-16 17:29:39.535116: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42014f00 of size 256 next 40
2020-09-16 17:29:39.535120: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015000 of size 256 next 41
2020-09-16 17:29:39.535126: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015100 of size 256 next 42
2020-09-16 17:29:39.535132: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015200 of size 256 next 43
2020-09-16 17:29:39.535138: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015300 of size 256 next 44
2020-09-16 17:29:39.535143: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015400 of size 256 next 45
2020-09-16 17:29:39.535149: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015500 of size 256 next 51
2020-09-16 17:29:39.535155: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015600 of size 256 next 53
2020-09-16 17:29:39.535161: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcc42015700 of size 256 next 54
2020-09-16 17:29:39.535167: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015800 of size 256 next 56
2020-09-16 17:29:39.535173: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42015900 of size 256 next 58
2020-09-16 17:29:39.535178: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcc42015a00 of size 34048 next 14
2020-09-16 17:29:39.535184: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4201df00 of size 256 next 15
2020-09-16 17:29:39.535190: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4201e000 of size 256 next 16
2020-09-16 17:29:39.535196: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4201e100 of size 40448 next 18
2020-09-16 17:29:39.535202: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42027f00 of size 40192 next 19
2020-09-16 17:29:39.535207: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42031c00 of size 40192 next 31
2020-09-16 17:29:39.535213: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4203b900 of size 40192 next 32
2020-09-16 17:29:39.535219: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42045600 of size 40192 next 35
2020-09-16 17:29:39.535225: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc4204f300 of size 40192 next 37
2020-09-16 17:29:39.535230: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42059000 of size 40192 next 38
2020-09-16 17:29:39.535237: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42062d00 of size 160000 next 57
2020-09-16 17:29:39.535243: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcc42089e00 of size 160000 next 46
2020-09-16 17:29:39.535248: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc420b0f00 of size 160000 next 48
2020-09-16 17:29:39.535254: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcc420d8000 of size 6156544 next 2
2020-09-16 17:29:39.535260: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc426b7100 of size 256 next 3
2020-09-16 17:29:39.535266: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc426b7200 of size 256 next 4
2020-09-16 17:29:39.535272: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc426b7300 of size 7040256 next 6
2020-09-16 17:29:39.535279: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc42d6e000 of size 7040000 next 7
2020-09-16 17:29:39.535284: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc43424c00 of size 400000000 next 30
2020-09-16 17:29:39.535290: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc5b19d000 of size 7040000 next 34
2020-09-16 17:29:39.535297: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc5b853c00 of size 28160000 next 47
2020-09-16 17:29:39.535303: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc5d32ec00 of size 28160000 next 49
2020-09-16 17:29:39.535309: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcc5ee09c00 of size 336640000 next 13
2020-09-16 17:29:39.535315: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc72f15400 of size 400000000 next 12
2020-09-16 17:29:39.535320: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcc8ac8d800 of size 400000000 next 36
2020-09-16 17:29:39.535326: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcca2a05c00 of size 1600000000 next 50
2020-09-16 17:29:39.535332: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcd01fe6c00 of size 1600000000 next 52
2020-09-16 17:29:39.535338: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] InUse at 7fcd615c7c00 of size 1600000000 next 55
2020-09-16 17:29:39.535344: I tensorflow/core/common_runtime/bfc_allocator.cc:1026] Free  at 7fcdc0ba8c00 of size 836672768 next 18446744073709551615
2020-09-16 17:29:39.535351: I tensorflow/core/common_runtime/bfc_allocator.cc:1031]      Summary of in-use Chunks by size: 
2020-09-16 17:29:39.535358: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 30 Chunks of size 256 totalling 7.5KiB
2020-09-16 17:29:39.535365: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 1 Chunks of size 1280 totalling 1.2KiB
2020-09-16 17:29:39.535372: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 8 Chunks of size 40192 totalling 314.0KiB
2020-09-16 17:29:39.535378: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 1 Chunks of size 40448 totalling 39.5KiB
2020-09-16 17:29:39.535384: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 2 Chunks of size 160000 totalling 312.5KiB
2020-09-16 17:29:39.535390: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 2 Chunks of size 7040000 totalling 13.43MiB
2020-09-16 17:29:39.535396: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 1 Chunks of size 7040256 totalling 6.71MiB
2020-09-16 17:29:39.535403: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 2 Chunks of size 28160000 totalling 53.71MiB
2020-09-16 17:29:39.535410: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 3 Chunks of size 400000000 totalling 1.12GiB
2020-09-16 17:29:39.535416: I tensorflow/core/common_runtime/bfc_allocator.cc:1034] 3 Chunks of size 1600000000 totalling 4.47GiB
2020-09-16 17:29:39.535422: I tensorflow/core/common_runtime/bfc_allocator.cc:1038] Sum Total of in-use chunks: 5.66GiB
2020-09-16 17:29:39.535429: I tensorflow/core/common_runtime/bfc_allocator.cc:1040] total_region_allocated_bytes_: 7257794816 memory_limit_: 7257794816 available bytes: 0 curr_region_allocation_bytes_: 14515589632
2020-09-16 17:29:39.535445: I tensorflow/core/common_runtime/bfc_allocator.cc:1046] Stats: 
Limit:                      7257794816
InUse:                      6078131200
MaxInUse:                   6078131456
NumAllocs:                         129
MaxAllocSize:               1600000000
Reserved:                            0
PeakReserved:                        0
LargestFreeBlock:                    0

2020-09-16 17:29:39.535457: W tensorflow/core/common_runtime/bfc_allocator.cc:439] *******____******************************************************************************___________
2020-09-16 17:29:39.535477: W tensorflow/core/framework/op_kernel.cc:1767] OP_REQUIRES failed at matmul_op.cc:481 : Resource exhausted: OOM when allocating tensor with shape[40000,10000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
Traceback (most recent call last):
  File "ranknet.py", line 589, in <module>
    ranker.model.fit(bg,
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[40000,10000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer1/MatMul_1 (defined at ranknet.py:589) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_811]

Function call stack:
train_function

2020-09-16 17:29:39.625190: W tensorflow/core/kernels/data/generator_dataset_op.cc:103] Error occurred when finalizing GeneratorDataset iterator: Failed precondition: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --sizes 10000 10000 --standardize --reduce_features
2020-09-16 17:29:50.277479: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
filtering Int64Index([9, 59, 72, 137, 138, 146, 150, 152, 164, 165, 176, 182, 183, 187,
            189, 196],
           dtype='int64')
filtering Int64Index([ 96,  19,  36,   5,   6,   7,   8,  22,   0,   2, 136, 149,  27,
             28,  29,  30, 180, 181, 102, 121, 123, 124, 125, 126],
           dtype='int64')
2020-09-16 17:29:53.079748: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:29:53.084014: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.084426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:29:53.084458: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:53.086422: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:29:53.087324: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:29:53.087545: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:29:53.089344: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:29:53.089756: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:29:53.089936: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:29:53.090062: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.090547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.091011: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:29:53.091351: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:29:53.096057: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:29:53.096398: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cb1f7bea00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:29:53.096425: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:29:53.171259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.171734: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cb1f7c7bf0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:29:53.171749: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070, Compute Capability 6.1
2020-09-16 17:29:53.171913: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.172306: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:29:53.172348: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:53.172416: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:29:53.172447: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:29:53.172487: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:29:53.172507: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:29:53.172547: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:29:53.172567: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:29:53.172618: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.173022: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.173392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:29:53.173429: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:29:53.476455: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:29:53.476487: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-16 17:29:53.476500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-16 17:29:53.476725: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.477137: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:29:53.477577: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6921 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:02:00.0, compute capability: 6.1)
2020-09-16 17:29:53.477986: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Epoch 1/5
2020-09-16 17:29:54.124845: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
13/13 [==============================] - 61s 5s/step - loss: 0.6409 - val_loss: 0.4237
Epoch 2/5
13/13 [==============================] - 63s 5s/step - loss: 0.3641 - val_loss: 0.3761
Epoch 3/5
13/13 [==============================] - 63s 5s/step - loss: 0.3066 - val_loss: 0.3737
Epoch 4/5
13/13 [==============================] - 63s 5s/step - loss: 0.2511 - val_loss: 0.3752
Epoch 5/5
13/13 [==============================] - 62s 5s/step - loss: 0.2015 - val_loss: 0.4198
train:  0.9229849673542198
test:  0.8297934918648311
val:  0.840566037735849
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --sizes 10000 10000 --standardize
2020-09-16 17:38:24.194791: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:38:26.501648: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-16 17:38:26.506218: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.506643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:38:26.506688: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:38:26.508686: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:38:26.509492: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:38:26.509735: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:38:26.511498: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:38:26.511921: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:38:26.512080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:38:26.512201: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.512682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.513069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:38:26.513374: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-16 17:38:26.519035: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3400255000 Hz
2020-09-16 17:38:26.519400: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561dc3658de0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:38:26.519418: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-16 17:38:26.588918: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.589402: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561dc3626290 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-16 17:38:26.589421: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1070, Compute Capability 6.1
2020-09-16 17:38:26.589642: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.590071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:02:00.0 name: GeForce GTX 1070 computeCapability: 6.1
coreClock: 1.835GHz coreCount: 15 deviceMemorySize: 7.92GiB deviceMemoryBandwidth: 238.66GiB/s
2020-09-16 17:38:26.590129: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:38:26.590199: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-16 17:38:26.590254: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-16 17:38:26.590307: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-16 17:38:26.590358: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-16 17:38:26.590408: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-16 17:38:26.590448: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-16 17:38:26.590522: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.590936: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.591296: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1858] Adding visible gpu devices: 0
2020-09-16 17:38:26.591330: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-16 17:38:26.907470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-16 17:38:26.907498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      0 
2020-09-16 17:38:26.907504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1276] 0:   N 
2020-09-16 17:38:26.907729: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.908160: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:982] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2020-09-16 17:38:26.908541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1402] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 6910 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070, pci bus id: 0000:02:00.0, compute capability: 6.1)
2020-09-16 17:38:26.908994: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
Epoch 1/5
 2020-09-16 17:38:27.547065: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
13/13 [==============================] - 59s 5s/step - loss: 0.8563 - val_loss: 0.4347
Epoch 2/5
13/13 [==============================] - 60s 5s/step - loss: 0.3702 - val_loss: 0.3870
Epoch 3/5
13/13 [==============================] - 59s 5s/step - loss: 0.3168 - val_loss: 0.3818
Epoch 4/5
13/13 [==============================] - 59s 5s/step - loss: 0.2679 - val_loss: 0.3969
Epoch 5/5
13/13 [==============================] - 60s 5s/step - loss: 0.2138 - val_loss: 0.3913
train:  0.9218938882250047
test:  0.8308260325406759
val:  0.8466981132075472
~/Documents/Uni/RTpred/roi $ export TF_CPP_MIN_LOG_LEVEL=2
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 30_000 --sizes 10000 10000 --standardize
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 10000)        2010000     Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        100010000   relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            10001       relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 102,030,001
Trainable params: 102,030,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 592, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[30000,10000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/functional_1/Identity_layer/MatMul (defined at ranknet.py:592) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_811]

Function call stack:
train_function

 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --sizes 10000 10000 --standardize
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 10000)        2010000     Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        100010000   relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            10001       relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 102,030,001
Trainable params: 102,030,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 63s 5s/step - loss: 0.8052 - val_loss: 0.4492
Epoch 2/5
13/13 [==============================] - 60s 5s/step - loss: 0.3713 - val_loss: 0.3907
Epoch 3/5
13/13 [==============================] - 63s 5s/step - loss: 0.3158 - val_loss: 0.3951
Epoch 4/5
13/13 [==============================] - 59s 5s/step - loss: 0.2669 - val_loss: 0.3879
Epoch 5/5
13/13 [==============================] - 59s 5s/step - loss: 0.2153 - val_loss: 0.4492
train:  0.9183989712682495
test:  0.8306914893617021
val:  0.8247641509433963
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 1000 200
Traceback (most recent call last):
  File "ranknet.py", line 575, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 187, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 30, in __init__
    raise ValueError('hidden_layer_sizes and activation should have the same size.')
ValueError: hidden_layer_sizes and activation should have the same size.
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 1000 200
[100, 1000, 200] 3
Traceback (most recent call last):
  File "ranknet.py", line 576, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 187, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 30, in __init__
    raise ValueError('hidden_layer_sizes and activation should have the same size.')
ValueError: hidden_layer_sizes and activation should have the same size.
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 1000 200
[100, 1000, 200] 3 ['relu', 'relu', 'relu']
Traceback (most recent call last):
  File "ranknet.py", line 576, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 187, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 30, in __init__
    raise ValueError('hidden_layer_sizes and activation should have the same size.')
ValueError: hidden_layer_sizes and activation should have the same size.
 ~/Documents/Uni/RTpred/roi $ 
 ~/Documents/Uni/RTpred/roi $ 
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 1000 200
[100, 1000, 200] 3 ['relu', 'relu', 'relu']
(100, 1000) ['relu', 'relu', 'relu']
Traceback (most recent call last):
  File "ranknet.py", line 576, in <module>
    ranker = RankNetNN(input_size=train_x.shape[1],
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 188, in __init__
    super(RankNetNN, self).__init__(input_size, hidden_layer_sizes, activation, solver)
  File "/home/fleming/.local/lib/python3.8/site-packages/LambdaRankNN/__init__.py", line 31, in __init__
    raise ValueError('hidden_layer_sizes and activation should have the same size.')
ValueError: hidden_layer_sizes and activation should have the same size.
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 1000 200
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100)          20100       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 1000)         101000      relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 200)          200200      relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            201         relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 321,501
Trainable params: 321,501
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 1s 48ms/step - loss: 0.4834 - val_loss: 0.4001
Epoch 2/5
13/13 [==============================] - 0s 35ms/step - loss: 0.3378 - val_loss: 0.3674
Epoch 3/5
13/13 [==============================] - 0s 36ms/step - loss: 0.2618 - val_loss: 0.4141
Epoch 4/5
13/13 [==============================] - 0s 36ms/step - loss: 0.2055 - val_loss: 0.4505
Epoch 5/5
13/13 [==============================] - 0s 36ms/step - loss: 0.1619 - val_loss: 0.5262
train:  0.9399748445645209
test:  0.8133260325406758
val:  0.8176100628930818
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 1000 10_000 5_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 1000)         201000      Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        10010000    relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 5000)         50005000    relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            5001        relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 60,221,001
Trainable params: 60,221,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 34s 3s/step - loss: 0.7363 - val_loss: 0.4319
Epoch 2/5
13/13 [==============================] - 37s 3s/step - loss: 0.3241 - val_loss: 0.4068
Epoch 3/5
13/13 [==============================] - 35s 3s/step - loss: 0.2439 - val_loss: 0.3969
Epoch 4/5
13/13 [==============================] - 34s 3s/step - loss: 0.1745 - val_loss: 0.4548
Epoch 5/5
13/13 [==============================] - 34s 3s/step - loss: 0.1242 - val_loss: 0.5042
train:  0.9570303164129474
test:  0.836846057571965
val:  0.8386006289308177
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 10_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 10000)        2010000     Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            10001       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 2,020,001
Trainable params: 2,020,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 2s 158ms/step - loss: 0.4846 - val_loss: 0.4380
Epoch 2/5
13/13 [==============================] - 2s 149ms/step - loss: 0.3356 - val_loss: 0.3823
Epoch 3/5
13/13 [==============================] - 2s 148ms/step - loss: 0.2946 - val_loss: 0.3678
Epoch 4/5
13/13 [==============================] - 2s 148ms/step - loss: 0.2625 - val_loss: 0.3833
Epoch 5/5
13/13 [==============================] - 2s 149ms/step - loss: 0.2342 - val_loss: 0.3837
train:  0.9085314161514348
test:  0.8252221526908636
val:  0.8511006289308176
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 1_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 1000)         201000      Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            1001        relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 202,001
Trainable params: 202,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 1s 40ms/step - loss: 0.4750 - val_loss: 0.4868
Epoch 2/5
13/13 [==============================] - 0s 32ms/step - loss: 0.3518 - val_loss: 0.4534
Epoch 3/5
13/13 [==============================] - 0s 31ms/step - loss: 0.3124 - val_loss: 0.4404
Epoch 4/5
13/13 [==============================] - 0s 32ms/step - loss: 0.2852 - val_loss: 0.4369
Epoch 5/5
13/13 [==============================] - 0s 31ms/step - loss: 0.2645 - val_loss: 0.4375
train:  0.8925449420688939
test:  0.8278598247809762
val:  0.8114779874213837
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 100 100
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100)          20100       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 100)          10100       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 100)          10100       relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            101         relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 40,401
Trainable params: 40,401
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 1s 41ms/step - loss: 0.6010 - val_loss: 0.5381
Epoch 2/5
13/13 [==============================] - 0s 30ms/step - loss: 0.4409 - val_loss: 0.5385
Epoch 3/5
13/13 [==============================] - 0s 31ms/step - loss: 0.3668 - val_loss: 0.4978
Epoch 4/5
13/13 [==============================] - 0s 32ms/step - loss: 0.3174 - val_loss: 0.4918
Epoch 5/5
13/13 [==============================] - 0s 30ms/step - loss: 0.2804 - val_loss: 0.4720
train:  0.8863102041876656
test:  0.8257040050062578
val:  0.7887578616352201
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 1000 1000 1000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 1000)         201000      Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 1000)         1001000     relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 1000)         1001000     relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            1001        relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 2,204,001
Trainable params: 2,204,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 2s 125ms/step - loss: 0.4279 - val_loss: 0.3995
Epoch 2/5
13/13 [==============================] - 1s 114ms/step - loss: 0.2616 - val_loss: 0.4380
Epoch 3/5
13/13 [==============================] - 1s 115ms/step - loss: 0.1766 - val_loss: 0.5570
Epoch 4/5
13/13 [==============================] - 2s 121ms/step - loss: 0.1342 - val_loss: 0.5541
Epoch 5/5
13/13 [==============================] - 1s 115ms/step - loss: 0.0948 - val_loss: 0.6693
train:  0.9625342044647651
test:  0.8321088861076346
val:  0.8282232704402516
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100000)       20100000    Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            100001      relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 20,200,001
Trainable params: 20,200,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[20000,100000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer0/MatMul_1 (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_697]

Function call stack:
train_function

~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 80_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 80000)        16080000    Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            80001       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 16,160,001
Trainable params: 16,160,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[20000,80000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer0/MatMul (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_697]

Function call stack:
train_function

 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 50_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 80000)        16080000    Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            80001       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 16,160,001
Trainable params: 16,160,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[10000,80000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node gradient_tape/functional_1/Identity_layer/MatMul (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_697]

Function call stack:
train_function

~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 50_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 50000)        10050000    Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            50001       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 10,100,001
Trainable params: 10,100,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[20000,50000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer0/MatMul (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_697]

Function call stack:
train_function

 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 10_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 10000)        2010000     Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            10001       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 2,020,001
Trainable params: 2,020,001
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 2s 160ms/step - loss: 0.4896 - val_loss: 0.4074
Epoch 2/5
13/13 [==============================] - 2s 149ms/step - loss: 0.3361 - val_loss: 0.3701
Epoch 3/5
13/13 [==============================] - 2s 149ms/step - loss: 0.2939 - val_loss: 0.3564
Epoch 4/5
13/13 [==============================] - 2s 149ms/step - loss: 0.2623 - val_loss: 0.3555
Epoch 5/5
13/13 [==============================] - 2s 149ms/step - loss: 0.2333 - val_loss: 0.3639
train:  0.9085366117663359
test:  0.8262265331664581
val:  0.8380503144654088
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 200 200
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 200)          40200       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 200)          40200       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            201         relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 80,601
Trainable params: 80,601
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
7/7 [==============================] - 0s 67ms/step - loss: 0.5606 - val_loss: 0.4744
Epoch 2/5
7/7 [==============================] - 0s 53ms/step - loss: 0.4291 - val_loss: 0.4382
Epoch 3/5
7/7 [==============================] - 0s 56ms/step - loss: 0.3761 - val_loss: 0.4218
Epoch 4/5
7/7 [==============================] - 0s 64ms/step - loss: 0.3384 - val_loss: 0.4211
Epoch 5/5
7/7 [==============================] - 0s 56ms/step - loss: 0.3137 - val_loss: 0.4338
train:  0.8671721566997455
test:  0.8229474342928661
val:  0.808254716981132
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 200 200 100
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 200)          40200       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 200)          40200       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 100)          20100       relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            101         relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 100,601
Trainable params: 100,601
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
7/7 [==============================] - 0s 68ms/step - loss: 0.5450 - val_loss: 0.4799
Epoch 2/5
7/7 [==============================] - 0s 57ms/step - loss: 0.4065 - val_loss: 0.4654
Epoch 3/5
7/7 [==============================] - 0s 57ms/step - loss: 0.3509 - val_loss: 0.4265
Epoch 4/5
7/7 [==============================] - 0s 56ms/step - loss: 0.3101 - val_loss: 0.4198
Epoch 5/5
7/7 [==============================] - 0s 55ms/step - loss: 0.2755 - val_loss: 0.4186
train:  0.8863307701633155
test:  0.8279005006257822
val:  0.8171383647798742
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 200 200 1000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 200)          40200       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 200)          40200       relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 1000)         201000      relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            1001        relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 282,401
Trainable params: 282,401
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
7/7 [==============================] - 1s 83ms/step - loss: 0.5353 - val_loss: 0.4202
Epoch 2/5
7/7 [==============================] - 0s 63ms/step - loss: 0.4007 - val_loss: 0.3914
Epoch 3/5
7/7 [==============================] - 0s 66ms/step - loss: 0.3375 - val_loss: 0.3694
Epoch 4/5
7/7 [==============================] - 0s 58ms/step - loss: 0.2931 - val_loss: 0.3713
Epoch 5/5
7/7 [==============================] - 0s 65ms/step - loss: 0.2533 - val_loss: 0.3710
train:  0.8984073275488821
test:  0.8176439299123905
val:  0.8425314465408805
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 100 200 1000
Traceback (most recent call last):
  File "ranknet.py", line 24, in <module>
    from classyfire import get_onehot
  File "/mnt/Data/Uni/RTpred/roi/classyfire.py", line 5, in <module>
    graph = obonet.read_obo('/home/fleming/Downloads/ChemOnt_2_1.obo')
  File "/home/fleming/.local/lib/python3.8/site-packages/obonet/read.py", line 24, in read_obo
    typedefs, terms, instances, header = get_sections(obo_file)
  File "/home/fleming/.local/lib/python3.8/site-packages/obonet/read.py", line 74, in get_sections
    term = parse_stanza(stanza_lines, term_tag_singularity)
  File "/home/fleming/.local/lib/python3.8/site-packages/obonet/read.py", line 118, in parse_stanza
    tag, value, trailing_modifier, comment = parse_tag_line(line)
  File "/home/fleming/.local/lib/python3.8/site-packages/obonet/read.py", line 95, in parse_tag_line
    match = re.match(tag_line_pattern, line)
  File "/usr/lib/python3.8/re.py", line 191, in match
    return _compile(pattern, flags).match(string)
  File "/usr/lib/python3.8/re.py", line 291, in _compile
    if isinstance(flags, RegexFlag):
KeyboardInterrupt
interrupt
 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 1000 200 1000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 1000)         201000      Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 200)          200200      relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 1000)         201000      relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            1001        relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 603,201
Trainable params: 603,201
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
7/7 [==============================] - 1s 103ms/step - loss: 0.5146 - val_loss: 0.3940
Epoch 2/5
7/7 [==============================] - 1s 88ms/step - loss: 0.3542 - val_loss: 0.4054
Epoch 3/5
7/7 [==============================] - 1s 88ms/step - loss: 0.2869 - val_loss: 0.3969
Epoch 4/5
7/7 [==============================] - 1s 89ms/step - loss: 0.2375 - val_loss: 0.4546
Epoch 5/5
7/7 [==============================] - 1s 87ms/step - loss: 0.1933 - val_loss: 0.4783
train:  0.9259466843317573
test:  0.8340456821026283
val:  0.8282232704402516
~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 40_000 --standardize --sizes 100 10_000 20_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100)          20100       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        1010000     relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 20000)        200020000   relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            20001       relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 201,070,101
Trainable params: 201,070,101
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[40000,20000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer2/MatMul (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_925]

Function call stack:
train_function

 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 10_000 20_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100)          20100       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        1010000     relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 20000)        200020000   relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            20001       relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 201,070,101
Trainable params: 201,070,101
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
Traceback (most recent call last):
  File "ranknet.py", line 586, in <module>
    ranker.model.fit(bg, callbacks=[callback],
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 108, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py", line 1098, in fit
    tmp_logs = train_function(iterator)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 780, in __call__
    result = self._call(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/def_function.py", line 840, in _call
    return self._stateless_fn(*args, **kwds)
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 2829, in __call__
    return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1843, in _filtered_call
    return self._call_flat(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 1923, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/function.py", line 545, in call
    outputs = execute.execute(
  File "/usr/lib/python3.8/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  OOM when allocating tensor with shape[20000,20000] and type float on /job:localhost/replica:0/task:0/device:GPU:0 by allocator GPU_0_bfc
	 [[node functional_1/relu_layer2/MatMul (defined at ranknet.py:586) ]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info.
 [Op:__inference_train_function_925]

Function call stack:
train_function

 ~/Documents/Uni/RTpred/roi $ python ranknet.py -i test.csv -t rdk -e 5 -b 20_000 --standardize --sizes 100 10_000 10_000
Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Input_layer1 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
Input_layer2 (InputLayer)       [(None, 200)]        0                                            
__________________________________________________________________________________________________
relu_layer0 (Dense)             (None, 100)          20100       Input_layer1[0][0]               
                                                                 Input_layer2[0][0]               
__________________________________________________________________________________________________
relu_layer1 (Dense)             (None, 10000)        1010000     relu_layer0[0][0]                
                                                                 relu_layer0[1][0]                
__________________________________________________________________________________________________
relu_layer2 (Dense)             (None, 10000)        100010000   relu_layer1[0][0]                
                                                                 relu_layer1[1][0]                
__________________________________________________________________________________________________
Identity_layer (Dense)          (None, 1)            10001       relu_layer2[0][0]                
                                                                 relu_layer2[1][0]                
__________________________________________________________________________________________________
Subtract_layer (Subtract)       (None, 1)            0           Identity_layer[0][0]             
                                                                 Identity_layer[1][0]             
__________________________________________________________________________________________________
Activation_layer (Activation)   (None, 1)            0           Subtract_layer[0][0]             
==================================================================================================
Total params: 101,050,101
Trainable params: 101,050,101
Non-trainable params: 0
__________________________________________________________________________________________________
Epoch 1/5
13/13 [==============================] - 59s 5s/step - loss: 0.6415 - val_loss: 0.4777
Epoch 2/5
13/13 [==============================] - 59s 5s/step - loss: 0.3577 - val_loss: 0.4463
Epoch 3/5
13/13 [==============================] - 60s 5s/step - loss: 0.2593 - val_loss: 0.4227
Epoch 4/5
13/13 [==============================] - 59s 5s/step - loss: 0.1736 - val_loss: 0.4865
Epoch 5/5
13/13 [==============================] - 59s 5s/step - loss: 0.1210 - val_loss: 0.6332
train:  0.9558504788625067
test:  0.8167991239048811
val:  0.8147798742138365
 ~/Documents/Uni/RTpred/roi $ 